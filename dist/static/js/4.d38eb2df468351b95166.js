webpackJsonp([4],{"G/LS":function(e,t,a){var i=a("Wr/d");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("8bSs")("4cc409b9",i,!0)},"Wr/d":function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"\n.edifice_main_container .sortlist {\n  overflow: auto;\n  -webkit-box-shadow: 0 0 15px inset #ccc;\n          box-shadow: 0 0 15px inset #ccc;\n}\n.edifice_main_container .sortlist > li {\n    margin: 20px auto;\n    width: 98%;\n    height: 200px;\n}\n.edifice_main_container .sortlist > li .floornumber {\n      margin: 10px;\n      width: 100%;\n      position: absolute;\n      left: 0;\n}\n.edifice_main_container .sortlist > li .floornumber span {\n        display: inline-block;\n        width: 40px;\n        height: 40px;\n        line-height: 40px;\n        text-align: center;\n        border: 1px solid #ccc;\n        font-size: 25px;\n        border-radius: 50%;\n        vertical-align: middle;\n}\n.edifice_main_container .sortlist > li .floornumber span p {\n          font-size: 15px;\n}\n.edifice_main_container .buildingname {\n  margin: 10px 15px;\n  min-height: 50px;\n  font-size: 15px;\n  position: absolute;\n  top: 0;\n  z-index: 1;\n}\n.edifice_main_container .buildingname label {\n    font-size: 15px;\n}\n.edifice_main_container .floordesc > li {\n  display: inline-block;\n}\n.edifice_main_container .advertisedesc .advertiselist li {\n  display: inline-block;\n  margin: 0 10px 0 0;\n}\n.edifice_main_container .advertisedesc .advertiselist li img {\n    display: inline-block;\n    width: 120px;\n}\n.edifice_main_container .advertisedesc .advertiselist li .advertisemeta {\n    display: inline-block;\n    vertical-align: top;\n}\n.edifice_main_container .advertisedesc .advertiselist li .advertisemeta .location {\n      width: 100px;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n}\n.edifice_main_container .operation {\n  float: right;\n}\n.edifice_sortadvertise_wrapper li {\n  display: inline-block;\n  margin: 10px;\n  width: 135px;\n  height: 135px;\n  text-align: center;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  vertical-align: middle;\n}\n.edifice_sortadvertise_wrapper li img {\n    display: inline-block;\n    width: 100%;\n    vertical-align: middle;\n}\n.edifice_sortadvertise_wrapper li:before {\n    content: '';\n    display: inline-block;\n    vertical-align: middle;\n}\n.edifice_sortadvertise_wrapper li:hover {\n    cursor: move;\n}\n.edifice_addminusadvertise_wrapper {\n  margin: 10px 0;\n  position: relative;\n  text-align: right;\n}\n.edifice_addminusadvertise_wrapper .minus {\n    display: inline-block;\n    width: 30px;\n    text-align: center;\n    position: absolute;\n    right: -40px;\n    top: 0;\n}\n.edifice_addminusadvertise_wrapper .minus a {\n      display: inline-block;\n      width: 20px;\n      height: 20px;\n      font-size: 20px;\n      text-align: center;\n      color: orangered;\n      vertical-align: middle;\n}\n",""])},rERP:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("aA9S"),n=a.n(i),o=a("pnga"),s=a("zQDM"),r=a("405r"),l=a.n(r),c={components:{CommonTag:o.a,CommonQuery:s.a,Draggable:l.a},data:function(){return{floorsListRequest:"building-show-service/1.0.0/bk/floors/list",addOrUpdateFloorsRequest:"building-show-service/1.0.0/bk/floors/addOrUpdate",deleteFloorsRequest:"building-show-service/1.0.0/bk/floors/delete",brandListRequest:"building-show-service/1.0.0/bk/brand/list",addBrandToFloorRequest:"building-show-service/1.0.0/bk/floors/addBrand",removeBrandToFloorRequest:"building-show-service/1.0.0/bk/floors/removeBrand",floorList:[],queryModel:{brandName:"",sort:"desc"},pagination:{page:1,size:20},formData:{id:0,name:"",title:"",description:"",iconUrl:"",bigImageUrl:"",iosDownloadUrl:"",androidDownloadUrl:"",webGameUrl:"",nature:"",ios:!1,android:!1,status:null},floorFormData:{buildingName:"",status:1,id:"",floorsRank:""},dialogStatus:"",textMap:{update:"Edit",create:"Create"},editFloorTextMap:{update:"编辑楼层",create:"创建楼层"},dialogPvVisible:!1,rules:{chosenBrandName:[{required:!0,message:"此项为不能为空",trigger:"change"}]},loading:!1,deviceType:"ios",editFloorDialogFlag:!1,addBrandDialogFlag:!1,currentSortData:[],chosenBrandData:{},currentBrandId:"",currentFloorData:{chosenBrandName:""},editBuildingNameFlag:!1}},computed:{layoutHeight:function(){return this.$store.state.app.layoutHeight-125}},watch:{effectiveDuration:function(e){console.log(e),null===e&&(e=[]),this.formData.startDate=e[0],this.formData.endDate=e[1]},"formData.bigImageUrl":function(e){console.warn(e)},chosenBrandName:function(e){this.queryModel.name=e},initSortData:function(e){console.log(e)}},mounted:function(){this.getSortList()},methods:{getSortList:function(){var e=this,t=this.queryModel;this.$http.get(this.$baseUrl+this.floorsListRequest,{params:n()(t,this.pagination)}).then(function(t){console.log(t),e.loading=!1,e.floorList=t.list,e.floorFormData.buildingName=t.list.filter(function(e){return""!==e.buildingName&&null!==e.buildingName})[0].buildingName,e.pagination.total=t.total})},handleAddFloor:function(){this.dialogStatus="create",this.editFloorDialogFlag=!0,this.floorFormData=n()(this.floorFormData,{id:"",status:1})},handleUpdateFloor:function(e){console.log(e),this.dialogStatus="update",this.editFloorDialogFlag=!0,this.floorFormData=n()(this.floorFormData,{id:e.id,buildingName:"",floorsRank:e.floorsRank})},updateFloor:function(){var e=this;this.$http.post(this.$baseUrl+this.addOrUpdateFloorsRequest,this.floorFormData).then(function(t){console.log(t),e.getSortList(),e.editFloorDialogFlag=!1,e.$message.success("楼层信息修改成功")}).catch(function(t){e.$message.error(t.response.status.toString()+"  "+t.response.data.error)})},handleAddBrand:function(e){this.dialogStatus="update",this.addBrandDialogFlag=!0,this.currentFloorData.chosenBrandName="",this.currentFloorData=e},addBrand:function(){var e=this;this.$refs.currentFloorData.validate(function(t){t&&e.$http.post(e.$baseUrl+e.addBrandToFloorRequest+"/"+e.currentFloorData.id+"/"+e.chosenBrandData.id,{}).then(function(t){switch(console.log(t),t.code){case 1e4:e.$message.success("品牌添加成功"),e.getSortList(),e.addBrandDialogFlag=!1;break;case 30002:e.$message.warning(t.message);break;case 30004:e.$message.error(t.message);break;default:e.$message.success(t.message),e.getSortList(),e.addBrandDialogFlag=!1}}).catch(function(t){e.$message.error(t.response.status.toString()+"  "+t.response.data.error)})})},removeBrand:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.currentFloorData=e,t.$http.post(t.$baseUrl+t.removeBrandToFloorRequest+"/"+t.currentFloorData.id,{}).then(function(e){switch(console.log(e),e.code){case 1e4:t.$message.success("品牌移除成功"),t.getSortList();break;case 30001:t.$message.error(e.message);break;default:t.$message.success(e.message),t.getSortList()}t.getSortList()})}).catch(function(e){})},removeFloor:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.delete(t.$baseUrl+t.deleteFloorsRequest+"/"+e.id).then(function(e){switch(console.log(e),e.code){case 1e4:t.$message.success("楼层移除成功"),t.getSortList();break;case 30001:t.$message.error(e.message);break;default:t.$message.success(e.message),t.getSortList()}}).catch(function(e){t.$message.error(e.response.status.toString()+"  "+e.response.data.error)})}).catch(function(){})},focusSortList:function(e,t){var a=this;console.log(this.gameOptions),this.$http.get(this.$baseUrl+this.brandListRequest,{params:{page:this.pagination.page,size:this.pagination.size,sort:this.queryModel.sort,brandName:this.currentFloorData.chosenBrandName}}).then(function(e){console.log(e);var a=[];0!==e.list.length&&(e.list.forEach(function(e,t){a.push(n()(e,{value:e.brandName}))}),console.log(a),t(a))}).catch(function(e){a.$message.error(e.response.status.toString()+"  "+e.response.data.error)})},chooseBrand:function(e){console.log(333,e),this.chosenBrandData=e},openAdvertiseUrl:function(e){window.open("//"+e)},handleSizeChange:function(e){this.pagination.size=e,this.getSortList()},handleCurrentChange:function(e){this.pagination.page=e,this.getSortList()},uploadSuccess:function(e){console.log(e),this.floorFormData.url=e.url},resetTemp:function(){this.floorFormData={id:"",buildingName:"",status:1}},saveBuildingName:function(){var e=this;this.editBuildingNameFlag=!0,this.floorFormData=n()(this.floorFormData,{id:this.floorList[0].id,floorsRank:this.floorList[0].floorsRank}),this.$http.post(this.$baseUrl+this.addOrUpdateFloorsRequest,this.floorFormData).then(function(t){console.log(t),e.getSortList(),e.$message.success("大楼名称修改成功"),e.editBuildingNameFlag=!1}).catch(function(t){e.$message.error(t.response.status.toString()+"  "+t.response.data.error)})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("CommonLoading",{attrs:{loading:e.loading,relative:!1}}),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"edifice_main_container common_sortlist_wrapper"},[a("el-form",{attrs:{inline:!0}},[e.editBuildingNameFlag?a("div",{staticClass:"buildingname"},[a("el-form-item",{attrs:{label:"大楼名称："}},[a("el-input",{on:{blur:function(t){e.editBuildingNameFlag=!1}},model:{value:e.floorFormData.buildingName,callback:function(t){e.$set(e.floorFormData,"buildingName",t)},expression:"floorFormData.buildingName"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-check"},on:{click:e.saveBuildingName},slot:"append"})],1)],1)],1):a("div",{staticClass:"buildingname"},[a("el-form-item",{attrs:{label:"大楼名称："}},[e._v("\n              "+e._s(e.floorFormData.buildingName)+"\n              "),a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(t){e.editBuildingNameFlag=!0}}})],1)],1)]),e._v(" "),a("ul",{staticClass:"add"},[a("li",[a("a",{staticClass:"plus",on:{click:e.handleAddFloor}},[a("span",{staticClass:"add el-icon-circle-plus-outline"})])])]),e._v(" "),a("ul",{staticClass:"sortlist",style:{height:e.layoutHeight+"px"}},e._l(e.floorList,function(t,i){return a("li",{key:t.id},[a("el-row",[a("el-col",{attrs:{span:1}},[a("div",{staticClass:"floornumber"},[a("span",[e._v("\n                    "+e._s(t.floorsRank)+"\n                  "),a("p",[e._v("楼")])])])]),e._v(" "),a("el-col",{attrs:{span:23}},[a("el-row",[a("el-col",{style:{minHeight:"10px"},attrs:{span:23}},[a("el-form",{ref:"form",refInFor:!0,staticClass:"maincontent",attrs:{"label-width":"150px"}},[null!==t.brand?a("el-row",{staticClass:"floordesc"},[a("el-col",{staticClass:"brandmeta",attrs:{span:4}},[a("el-form-item",{attrs:{label:"品牌名称："}},[a("span",[e._v(e._s(t.brand.brandName))])])],1),e._v(" "),a("el-col",{staticClass:"brandmeta",attrs:{span:3}},[a("el-form-item",{attrs:{label:"key总数量："}},[a("span",[e._v(e._s(t.brand.keyTotal))])])],1),e._v(" "),a("el-col",{staticClass:"brandmeta",attrs:{span:3}},[a("el-form-item",{attrs:{label:"key已领取数："}},[a("span",[e._v(e._s(t.brand.keyReceived))])])],1),e._v(" "),a("el-col",{staticClass:"brandmeta",attrs:{span:3}},[a("el-form-item",{attrs:{label:"key可用数："}},[a("span",[e._v(e._s(t.brand.keyEnable))])])],1),e._v(" "),a("el-col",{staticClass:"brandmeta",attrs:{span:3}},[a("el-form-item",{attrs:{label:"每用户可领取key数："}},[a("span",[e._v(e._s(t.brand.keyNumPerUser))])])],1)],1):e._e(),e._v(" "),a("el-row",{staticClass:"advertisedesc"},[null!==t.brand?a("el-col",{staticClass:"brandmeta",attrs:{span:3}},[a("el-form-item",{attrs:{label:"品牌icon："}},[a("img",{attrs:{src:t.brand.icon+"-style_100x100"}})])],1):e._e(),e._v(" "),null!==t.brand?a("el-col",{staticClass:"brandmeta",attrs:{span:21}},[a("el-form-item",{attrs:{label:"广告："}},[a("ul",{staticClass:"advertiselist"},e._l(t.brand.advertisements,function(t){return a("li",[a("img",{attrs:{src:""!==t.url?t.url+"-style_100x100":"/static/img/default/empty_700_700.jpg"}}),e._v(" "),a("el-form",{ref:"form",refInFor:!0,staticClass:"advertisemeta",attrs:{"label-width":"130px"}},[a("el-form-item",{attrs:{label:"Android可用性："}},[!0===t.androidEnable?a("el-tag",{attrs:{type:"success"}},[e._v("可用")]):e._e(),e._v(" "),!1===t.androidEnable?a("el-tag",{attrs:{type:"error"}},[e._v("不可用")]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"iOS可用性："}},[!0===t.iosEnable?a("el-tag",{attrs:{type:"success"}},[e._v("可用")]):e._e(),e._v(" "),!1===t.iosEnable?a("el-tag",{attrs:{type:"error"}},[e._v("不可用")]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"链接："}},[a("el-button",{staticClass:"location",attrs:{type:"text"},on:{click:function(a){e.openAdvertiseUrl(t.location)}}},[e._v("\n                                      "+e._s(t.url)+"\n                                    ")])],1)],1)],1)}))])],1):e._e(),e._v(" "),a("el-col",{staticClass:"operation",attrs:{span:3}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:1}},[a("el-form",[a("el-row",[a("el-form-item",[t.floorsRank===e.pagination.total?a("a",{staticClass:"minus",on:{click:function(a){e.removeFloor(t)}}},[a("span",{staticClass:"add el-icon-remove-outline"})]):e._e()])],1),e._v(" "),a("el-row",[a("ul",{},[a("li",[a("el-button",{attrs:{type:"primary",size:"mini",disable:t!=={}},on:{click:function(a){e.handleAddBrand(t)}}},[e._v("\n                              添加品牌\n                            ")])],1),e._v(" "),a("li",[a("el-button",{attrs:{type:"primary",size:"mini",disable:t==={}},on:{click:function(a){e.removeBrand(t)}}},[e._v("\n                              移除品牌\n                            ")])],1),e._v(" "),a("li",[a("el-button",{attrs:{type:"primary",size:"mini",disable:t!=={}},on:{click:function(a){e.handleUpdateFloor(t)}}},[e._v("\n                              编辑楼层\n                            ")])],1)])])],1)],1)],1)],1)],1)],1)}))],1)])],1),e._v(" "),a("div",{staticClass:"common-pagination-wrapper"},[a("el-pagination",{attrs:{background:"","current-page":e.pagination.page,"page-sizes":[10,20,30,50],"page-size":e.pagination.size,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.editFloorTextMap[e.dialogStatus],visible:e.editFloorDialogFlag,width:"600px"},on:{"update:visible":function(t){e.editFloorDialogFlag=t}}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form",{ref:"queryModel",attrs:{rules:e.rules,model:e.queryModel,"label-position":"right","label-width":"150px"}},[a("el-form-item",{attrs:{label:"是否上架",prop:"status"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.floorFormData.status,callback:function(t){e.$set(e.floorFormData,"status",t)},expression:"floorFormData.status"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],on:{click:function(t){e.editFloorDialogFlag=!1}}},[e._v(e._s(e.$t("table.cancel")))]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary"},on:{click:e.updateFloor}},[e._v(e._s(e.$t("table.confirm")))])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.addBrandDialogFlag,width:"600px"},on:{"update:visible":function(t){e.addBrandDialogFlag=t}}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form",{ref:"currentFloorData",attrs:{rules:e.rules,model:e.currentFloorData,"label-position":"right","label-width":"150px"}},[a("el-form-item",{attrs:{label:"品牌名称",prop:"chosenBrandName"}},[a("el-autocomplete",{attrs:{"fetch-suggestions":e.focusSortList,placeholder:"请输入内容"},on:{select:e.chooseBrand},model:{value:e.currentFloorData.chosenBrandName,callback:function(t){e.$set(e.currentFloorData,"chosenBrandName",t)},expression:"currentFloorData.chosenBrandName"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],on:{click:function(t){e.addBrandDialogFlag=!1}}},[e._v(e._s(e.$t("table.cancel")))]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary"},on:{click:e.addBrand}},[e._v(e._s(e.$t("table.confirm")))])],1)],1)],1)},staticRenderFns:[]};var u=a("vSla")(c,d,!1,function(e){a("G/LS")},null,null);t.default=u.exports}});