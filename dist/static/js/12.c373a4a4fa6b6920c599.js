webpackJsonp([12],{fWAY:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("aA9S"),i=a.n(s),r={components:{CommonQuery:a("zQDM").a},data:function(){return{virtualAssetListRequest:"asset-service/1.0.0/virtualAsset/list",addOrUpdateVirtualAssetRequest:"asset-service/1.0.0/virtualAsset/addOrUpdate",deleteVirtualAssetRequest:"asset-service/1.0.0/virtualAsset/delete",listLoading:!1,tableKey:0,tableList:[],total:null,queryModel:{virtualName:""},chosenVirtualAssetInfo:{},virtualAssetQueryModel:{virtualName:""},pagination:{page:1,size:20},virtualAssetPagination:{page:1,size:20},formData:{id:"",assetType:"",assetKey:"",assetValue:"",describe:""},rules:{assetType:[{required:!0,message:"此项为必填项",trigger:"change"}],assetKey:[{required:!0,message:"此项为必填项",trigger:"change"}],assetValue:[{required:!0,message:"此项为必填项",trigger:"change"}],describe:[{required:!0,message:"此项为必填项",trigger:"change"}]},skuRules:{k:[{required:!0,message:"此项为必填项",trigger:"change"}],v:[{required:!1,message:"此项为必填项",trigger:"change"}]},skuPropertiesListFormData:[{k:"",v:""}],skuVirtualPropertyForm:[],skuTypeDictionary:[{name:"普通商品",code:"ordinary"},{name:"虚拟商品",code:"virtual"}],temporaryExcel:"",dailyLimitMode:"",dialogFormVisible:!1,dialogStatus:"",textMap:{update:"Edit",create:"Create"},dialogPvVisible:!1,importExcelFlag:!1,modifySkuVirtualPropertyFlag:!1,expandQuery:"",currentSortData:[],effectiveDuration:[],skuVirtualListFormData:[{k:"",v:""}],currentSkuNo:"",virtualAssetList:[],addVirtualAssetFlag:!1,editingVirtualAssetIndex:null,temporaryEditingSkuData:{}}},computed:{tableHeight:function(){return this.$store.state.app.tableHeight}},watch:{effectiveDuration:function(t){console.log(t),null===t&&(t=[]),this.formData.startDate=this.$moment(t[0]).format("YYYY-MM-DD"),this.formData.endDate=this.$moment(t[1]).format("YYYY-MM-DD")},currentAdvertisementTabIndex:function(t){console.log(t)},currentSortData:function(t){var e=this;console.log(t),t.forEach(function(t,a){e.tableList.forEach(function(s,i){t.id===s.id&&(e.tableList[i].orderNum=a)})}),console.log(this.tableList)},skuPropertiesListFormData:function(t){console.log(t),this.formData.skuPropertiesList=t}},mounted:function(){this.getTableData()},methods:{getTableData:function(){var t=this;this.listLoading=!0,this.queryModel=i()(this.queryModel,this.pagination),this.$http.get(this.$baseUrl+this.virtualAssetListRequest,{params:this.queryModel}).then(function(e){console.log(e),t.tableList=e.list,t.total=e.total,t.listLoading=!1}).catch(function(t){console.log(t)})},getActivityList:function(){var t=this;this.listLoading=!0,this.$http.get(this.$baseUrl+this.queryRotaryTableActivityListRequest).then(function(e){console.log(e),t.activityList=e.data,t.formData.activityId=e.data[0].id,t.total=e.total,t.listLoading=!1,t.getTableData()})},handleFilter:function(){this.pagination.page=1,this.getTableData()},handleSizeChange:function(t){this.pagination.size=t,this.getTableData()},handleCurrentChange:function(t){this.pagination.page=t,this.getTableData()},resetTemp:function(){this.formData=i()(this.formData,{id:"",assetType:"",assetKey:"",assetValue:"",describe:""})},handleCreate:function(){var t=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,void 0!==this.$refs.formData&&this.$nextTick(function(){t.$refs.formData.clearValidate()})},createData:function(){this.formData.id="",this.updateData()},handleSkuVirtualPropertyUpdate:function(t){console.log("handleSkuVirtualPropertyUpdate",t),this.currentSkuNo=t.row.skuNo,t.row.skuVirtualList.length>0&&(this.skuVirtualListFormData=t.row.skuVirtualList),this.chosenReward=t.row.rewardName,this.dialogStatus="update",this.modifySkuVirtualPropertyFlag=!0,this.$nextTick(function(){})},handleUpdate:function(t){var e=this;console.log("handleUpdate",t),this.formData=i()({},{id:t.row.id,assetType:t.row.assetType,assetKey:t.row.assetKey,assetValue:t.row.assetValue,describe:t.row.describe}),this.skuPropertiesListFormData=t.row.skuPropertiesList,this.chosenReward=t.row.rewardName,this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.formData.clearValidate()})},updateData:function(){var t=this,e={};"create"===this.dialogStatus||(e=this.formData),console.log(e),this.$refs.formData.validate(function(e){e&&t.$http.post(t.$baseUrl+t.addOrUpdateVirtualAssetRequest,t.formData,{}).then(function(e){console.log(e),t.dialogFormVisible=!1,t.$message.success("信息修改成功"),t.getTableData()}).catch(function(e){console.log(e),t.$message.error(e.response.status.toString()+"  "+e.response.data.error)})})},handleDelete:function(t){var e=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.delete(e.$baseUrl+e.deleteVirtualAssetRequest+"/"+t.row.id).then(function(t){console.log(t),e.dialogFormVisible=!1,e.$message.success("删除成功"),e.getTableData()}).catch(function(t){console.log(t),e.$message.error(t.response.status.toString()+"  "+t.response.data.error)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},expand:function(){this.expandQuery=!this.expandQuery},search:function(){this.getTableData()},reset:function(){this.queryModel.available=!0},deleteAdvertise:function(t,e){this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){})},uploadSuccess1:function(t,e,a){this.loading=!1,this.formData.picUrl=t.url},uploadSuccess2:function(t){this.$message.success("Excel上传成功")},addInputItem1:function(){this.skuPropertiesListFormData.push({k:"",v:""})},minusInputItem1:function(t){this.skuPropertiesListFormData.splice(t,1)},addInputItem2:function(){this.skuVirtualListFormData.push({k:"",v:""})},minusInputItem2:function(t){this.skuVirtualListFormData.splice(t,1)},chooseVirtualAsset:function(t){this.chosenVirtualAssetInfo=t},focusSortList:function(t,e){var a=this;console.log(t),this.loading=!0,console.log(this.virtualAssetQueryModel),this.virtualAssetQueryModel=i()({virtualName:t},this.virtualAssetPagination),this.$http.get(this.$baseUrl+this.virtualAssetRequest,{params:this.virtualAssetQueryModel}).then(function(t){console.log(t),a.loading=!1;var s=[];0!==t.list.length&&(t.list.forEach(function(t,e){s.push(i()(t,{name:t.assetKey,value:t.assetKey}))}),console.log(s),e(s))})},editVirtualAsset:function(t){this.addVirtualAssetFlag=!0,this.editingVirtualAssetIndex=t,this.temporaryEditingSkuData={k:this.skuVirtualListFormData[this.editingVirtualAssetIndex].k,v:this.skuVirtualListFormData[this.editingVirtualAssetIndex].v}},saveVirtualAsset:function(){var t=this;console.log(this.$refs.skuVirtualPropertyForm[this.editingVirtualAssetIndex]),this.$refs.skuVirtualPropertyForm[this.editingVirtualAssetIndex].validate(function(e){if(e){console.log(t.chosenVirtualAssetInfo);var a={k:t.skuVirtualListFormData[t.editingVirtualAssetIndex].k,v:t.skuVirtualListFormData[t.editingVirtualAssetIndex].v};t.$http.post(t.$baseUrl+t.addOrUpdateSku_virtualRequest+"/"+t.currentSkuNo,a,{headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){var e="";for(var a in t)e+=encodeURIComponent(a)+"="+encodeURIComponent(t[a])+"&";return e}]}).then(function(e){console.log(e),t.addVirtualAssetFlag=!1,t.editingVirtualAssetFlag=!1})}})},cancelEditVirtualAsset:function(){this.addVirtualAssetFlag=!1,this.skuVirtualListFormData[this.editingVirtualAssetIndex]=this.temporaryEditingSkuData},closeEditVirtualProperty:function(){var t=this;this.modifySkuVirtualPropertyFlag=!1,this.editingVirtualAssetIndex=null,this.skuVirtualListFormData.forEach(function(e,a){(""===e.k||e.v<1)&&t.skuVirtualListFormData.splice(a)})}}},o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"app-container"},[a("CommonQuery",[a("template",{slot:"button1"},[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:t.handleCreate}},[t._v("\n        新增\n      ")])],1),t._v(" "),a("template",{slot:"query1"},[a("div",{staticClass:"common-search-wrapper",on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.search(e)}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.queryModel.virtualName,expression:"queryModel.virtualName"}],attrs:{type:"text",placeholder:"请输入游戏名称"},domProps:{value:t.queryModel.virtualName},on:{input:function(e){e.target.composing||t.$set(t.queryModel,"virtualName",e.target.value)}}}),t._v(" "),a("a",[a("span",{staticClass:"el-icon-search",on:{click:t.search}})])])])],2),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:t.tableList,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":"",height:t.tableHeight}},[a("el-table-column",{attrs:{label:"No",type:"index",width:"50",align:"center",fixed:""}}),t._v(" "),a("el-table-column",{attrs:{label:"虚拟资产Type",align:"center",prop:"assetType"}}),t._v(" "),a("el-table-column",{attrs:{label:"虚拟资产Key",align:"center",prop:"assetKey"}}),t._v(" "),a("el-table-column",{attrs:{label:"虚拟资产Value",align:"center",prop:"assetValue"}}),t._v(" "),a("el-table-column",{attrs:{label:"虚拟资产描述",align:"center",prop:"describe"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.handleUpdate(e)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){t.handleDelete(e)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("div",{staticClass:"common-pagination-wrapper"},[a("el-pagination",{attrs:{background:"","current-page":t.pagination.page,"page-sizes":[10,20,30,50],"page-size":t.pagination.size,total:t.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.pagination,"page",e)}}})],1),t._v(" "),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,width:"850px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form",{ref:"formData",attrs:{rules:t.rules,model:t.formData,"label-position":"right","label-width":"140px"}},[a("el-form-item",{attrs:{label:"虚拟资产Type",prop:"assetType"}},[a("el-input",{model:{value:t.formData.assetType,callback:function(e){t.$set(t.formData,"assetType",e)},expression:"formData.assetType"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"虚拟资产Key",prop:"assetKey"}},[a("el-input",{model:{value:t.formData.assetKey,callback:function(e){t.$set(t.formData,"assetKey",e)},expression:"formData.assetKey"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"虚拟资产Value",prop:"assetValue"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:t.formData.assetValue,callback:function(e){t.$set(t.formData,"assetValue",e)},expression:"formData.assetValue"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"虚拟资产描述",prop:"describe"}},[a("el-input",{model:{value:t.formData.describe,callback:function(e){t.$set(t.formData,"describe",e)},expression:"formData.describe"}})],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(t._s(t.$t("table.cancel")))]),t._v(" "),"create"===t.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v(t._s(t.$t("table.confirm")))]):a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary"},on:{click:t.updateData}},[t._v(t._s(t.$t("table.confirm")))])],1)],1)],1)};o._withStripped=!0;var n={render:o,staticRenderFns:[]},l=n;var u=!1;var c=a("vSla")(r,l,!1,function(t){u||a("xKLl")},null,null);c.options.__file="src\\views\\eCommerce\\ECommerceVirtualAssetsManagement.vue";e.default=c.exports},mQJq:function(t,e,a){(t.exports=a("BkJT")(!1)).push([t.i,"/*@import '../../styles/edifice.scss';*/\n",""])},xKLl:function(t,e,a){var s=a("mQJq");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("8bSs")("4d3e5fd2",s,!1)}});
//# sourceMappingURL=12.c373a4a4fa6b6920c599.js.map